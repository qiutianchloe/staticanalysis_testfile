<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>insec.c.8bbf6441c46fd2c488a9a5719116ed53</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
body { background-color:#fff; color:#000; font-family:Helvetica, sans-serif; font-size:10pt }
h1 { font-size:14pt }
.code { border-collapse:collapse; width:100%; font-family: "Andale Mono", monospace; font-size:10pt; line-height: 1.2em }
.color_black { color: black }
.color_blue { color: blue }
.color_green { color: green }
.color_orange { color: orange }
.color_red { color: red }
.line { border-left: 3px solid #ccc; padding-left: 1ex; white-space: pre; }
.msg { background-color:#fff8b4; color:#000; float:left; font-family:Helvetica, sans-serif; font-size: smaller; font-weight: bold; margin-bottom:10px; margin-top:10px; max-width:60em; padding:0.5em 1ex 0.5em 1ex; -webkit-border-radius:5px; -webkit-box-shadow:1px 1px 7px #000; white-space: pre-wrap; word-wrap: break-word; }
.num { background-color:#eee; color:#444; font-size: smaller; padding-right:2ex; text-align:right; width:2.5em; }
.dangling { background-color:white; color: gray; }
.visited { background-color:LemonChiffon; color: darkmagenta; }
.tooltip { display: none; background-color:#FFF0F0; border: 2px solid #F00; font-weight: normal; left:10em; padding: 2px; position: absolute; top: -1em; -webkit-border-radius:5px; -webkit-box-shadow:1px 1px 7px #000; z-index: 1}
.with_tooltip { position: relative; }
.with_tooltip:hover .tooltip, .visited:hover .tooltip { display: block; }
</style>
</head>
<body>
<center><h1>File examples/insec.c </h1></center>
<table class="code">
<tr><td class="num" id="LINE1">1</td><td class="line">#include &quot;underflow.h&quot; </td></tr>
<tr><td class="num" id="LINE2">2</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE3">3</td><td class="line">/* the current semantics of Underflow is as follows:  </td></tr>
<tr><td class="num" id="LINE4">4</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE5">5</td><td class="line">   It has two modes of operation: &quot;validate&quot; mode and &quot;discover&quot; mode. </td></tr>
<tr><td class="num" id="LINE6">6</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE7">7</td><td class="line">   Validate Mode: </td></tr>
<tr><td class="num" id="LINE8">8</td><td class="line">   ------------- </td></tr>
<tr><td class="num" id="LINE9">9</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE10">10</td><td class="line">   Validate mode is the default. In this mode: </td></tr>
<tr><td class="num" id="LINE11">11</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE12">12</td><td class="line">   Each _(presumes P covers Q) or  </td></tr>
<tr><td class="num" id="LINE13">13</td><td class="line">        _(presumes P fails kind Q) for each function forms a specification. </td></tr>
<tr><td class="num" id="LINE14">14</td><td class="line">   </td></tr>
<tr><td class="num" id="LINE15">15</td><td class="line">   /kind/ is either &quot;memory&quot; (for memory-safety errors) or &quot;insecure&quot; for </td></tr>
<tr><td class="num" id="LINE16">16</td><td class="line">   information flow errors. </td></tr>
<tr><td class="num" id="LINE17">17</td><td class="line">    </td></tr>
<tr><td class="num" id="LINE18">18</td><td class="line">   Underflow then symbolically executes from P. For each /kind/ final state T </td></tr>
<tr><td class="num" id="LINE19">19</td><td class="line">   reached, it checks whether T is consistent and whether (exists vs. T(old)) &lt;== Q, </td></tr>
<tr><td class="num" id="LINE20">20</td><td class="line">   where T(old) denotes T but with all function arguments referring to their *initial* </td></tr>
<tr><td class="num" id="LINE21">21</td><td class="line">   values, and vs are local variables in state T. If this implications holds for any  </td></tr>
<tr><td class="num" id="LINE22">22</td><td class="line">   such final state, the contract is satisfied. </td></tr>
<tr><td class="num" id="LINE23">23</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE24">24</td><td class="line">   We check Q ==&gt; (exists vs. T(old)) for two reasons: </td></tr>
<tr><td class="num" id="LINE25">25</td><td class="line">   1. We use T(old) rather than T because we are proving a contract that we wish to refer </td></tr>
<tr><td class="num" id="LINE26">26</td><td class="line">      to the function's *external* behaviour: when a caller calls the function it does not </td></tr>
<tr><td class="num" id="LINE27">27</td><td class="line">      see modifications to local variables like paramters.  </td></tr>
<tr><td class="num" id="LINE28">28</td><td class="line">   2. This also explains why we use (exists vs. ...) because the vs are local variables that  </td></tr>
<tr><td class="num" id="LINE29">29</td><td class="line">      are not visible outside the function. </td></tr>
<tr><td class="num" id="LINE30">30</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE31">31</td><td class="line">   The upshot of this is that when we write: </td></tr>
<tr><td class="num" id="LINE32">32</td><td class="line">   _(presumes P (covers | fails blah) Q) any (non-spatial) constraints that Q places on the  </td></tr>
<tr><td class="num" id="LINE33">33</td><td class="line">   function arguments can effectively be treated as a precondition since this triple says for  </td></tr>
<tr><td class="num" id="LINE34">34</td><td class="line">   all states that satisfy Q, there exists a state satisfying P that can reach the Q-state. </td></tr>
<tr><td class="num" id="LINE35">35</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE36">36</td><td class="line">   For this reason, the presumption P often looks weaker than one might expect, but that is </td></tr>
<tr><td class="num" id="LINE37">37</td><td class="line">   no problem because all useful information can be put into the result Q without loss of </td></tr>
<tr><td class="num" id="LINE38">38</td><td class="line">   fidelity. Indeed if Q' is the pure part of Q, we have that if </td></tr>
<tr><td class="num" id="LINE39">39</td><td class="line">   _(presumes P (covers | fails blah) Q) holds, then it follows that </td></tr>
<tr><td class="num" id="LINE40">40</td><td class="line">   _(presumes P &amp;*&amp; Q' (covers | fails blah) Q) must also hold. </td></tr>
<tr><td class="num" id="LINE41">41</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE42">42</td><td class="line">   Note that in Underflow's current implementation, for contracts that want to quantify over  </td></tr>
<tr><td class="num" id="LINE43">43</td><td class="line">   logical variables, the variable should be introduced via &quot;exists&quot; in the presumption,  </td></tr>
<tr><td class="num" id="LINE44">44</td><td class="line">   and can then be referred to freely in the result, for instance: </td></tr>
<tr><td class="num" id="LINE45">45</td><td class="line">   _(presumes exists x. P covers Q) where P and Q mention x, means </td></tr>
<tr><td class="num" id="LINE46">46</td><td class="line">   forall x. _(presumes P covers Q) </td></tr>
<tr><td class="num" id="LINE47">47</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE48">48</td><td class="line">   If any contract is not satisfied, Underflow reports that the contract is unreachable.  </td></tr>
<tr><td class="num" id="LINE49">49</td><td class="line">   XXX: at present this happens for any function for which symbolic execution </td></tr>
<tr><td class="num" id="LINE50">50</td><td class="line">        cannot find any consistent final state. </td></tr>
<tr><td class="num" id="LINE51">51</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE52">52</td><td class="line">   Underflow will use bi-abduction based symbolic execution (SE) </td></tr>
<tr><td class="num" id="LINE53">53</td><td class="line">   to strengthen specifications as needed to progress symbolic execution and </td></tr>
<tr><td class="num" id="LINE54">54</td><td class="line">   to help it discover as many paths as it can.  </td></tr>
<tr><td class="num" id="LINE55">55</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE56">56</td><td class="line">   Discover Mode: </td></tr>
<tr><td class="num" id="LINE57">57</td><td class="line">   -------------- </td></tr>
<tr><td class="num" id="LINE58">58</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE59">59</td><td class="line">   In Discover mode (enabled via the -discover option), Underflow uses SE to </td></tr>
<tr><td class="num" id="LINE60">60</td><td class="line">   infer as many contracts as it can for each function. When function f calls </td></tr>
<tr><td class="num" id="LINE61">61</td><td class="line">   function g, it uses the contracts on function g to progress symbolic </td></tr>
<tr><td class="num" id="LINE62">62</td><td class="line">   execution, so its ability to discover contracts for function f will depend on </td></tr>
<tr><td class="num" id="LINE63">63</td><td class="line">   the quality of the contracts for those functions f calls.    </td></tr>
<tr><td class="num" id="LINE64">64</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE65">65</td><td class="line">   Command-line options (all optional): </td></tr>
<tr><td class="num" id="LINE66">66</td><td class="line">   ------------------------------------ </td></tr>
<tr><td class="num" id="LINE67">67</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE68">68</td><td class="line">     -strengthen </td></tr>
<tr><td class="num" id="LINE69">69</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE70">70</td><td class="line">     Supplying the -strengthen option causes Underflow to back-propagate non-spatial assertions, </td></tr>
<tr><td class="num" id="LINE71">71</td><td class="line">     which at present it does not do by default as such information always shows up in the </td></tr>
<tr><td class="num" id="LINE72">72</td><td class="line">     result anyway and so avoids duplication in the discovered contracts </td></tr>
<tr><td class="num" id="LINE73">73</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE74">74</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE75">75</td><td class="line">     -discover </td></tr>
<tr><td class="num" id="LINE76">76</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE77">77</td><td class="line">     Runs Underflow is discover mode (see above). </td></tr>
<tr><td class="num" id="LINE78">78</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE79">79</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE80">80</td><td class="line">     -loop N </td></tr>
<tr><td class="num" id="LINE81">81</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE82">82</td><td class="line">     For a positive integer N, defines how many times to unroll loops. </td></tr>
<tr><td class="num" id="LINE83">83</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE84">84</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE85">85</td><td class="line">     -timeout Nmillisecs </td></tr>
<tr><td class="num" id="LINE86">86</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE87">87</td><td class="line">     For a positive integer Nmillisecs defines the solver timeout in </td></tr>
<tr><td class="num" id="LINE88">88</td><td class="line">     milliseconds. </td></tr>
<tr><td class="num" id="LINE89">89</td><td class="line">*/ </td></tr>
<tr><td class="num" id="LINE90">90</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE91">91</td><td class="line">/* Note, from above, that the &quot;covers&quot; (likeewise &quot;fails&quot;) condition refers to the  </td></tr>
<tr><td class="num" id="LINE92">92</td><td class="line">   *initial* values of parameters, and can also refer to a distinguished variable called &quot;result&quot; </td></tr>
<tr><td class="num" id="LINE93">93</td><td class="line">   that denotes the return-value (if the function has one). */ </td></tr>
<tr><td class="num" id="LINE94">94</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE95">95</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE96">96</td><td class="line">/* note that in under-approximate logics like InsecSL (Insecurity </td></tr>
<tr><td class="num" id="LINE97">97</td><td class="line">   Separation Logic) the result assertion must imply the final state, </td></tr>
<tr><td class="num" id="LINE98">98</td><td class="line">   which is the reverse for ordinary Hoare logic. This is why we use </td></tr>
<tr><td class="num" id="LINE99">99</td><td class="line">   the keyword 'covers', to sugges that the final states reachable </td></tr>
<tr><td class="num" id="LINE100">100</td><td class="line">   cover the case e.g. as below in which x &gt; 1, under the presumption </td></tr>
<tr><td class="num" id="LINE101">101</td><td class="line">   that e.g. x &gt; 0. */ </td></tr>
<tr><td class="num" id="LINE102">102</td><td class="line">void test_conseq(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test_conseq.f668eea43cf5d2886a325446c8857c75_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:2 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test_conseq.f668eea43cf5d2886a325446c8857c75.html">summary for test_conseq</a></td></tr>
<tr><td class="num" id="LINE103">103</td><td class="line">  _(presumes x &gt; 0 covers x &gt; 1) </td></tr>
<tr><td class="num" id="LINE104">104</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE105">105</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test_conseq.f668eea43cf5d2886a325446c8857c75_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:1 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE106">106</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE107">107</td><td class="line">/* when calling a function, we conjoin the non-spatial part of its presumption </td></tr>
<tr><td class="num" id="LINE108">108</td><td class="line">   with the current state, to make its presumption valid. This works because </td></tr>
<tr><td class="num" id="LINE109">109</td><td class="line">   the consequence rule of under-approximate logic allows us to strengthen the </td></tr>
<tr><td class="num" id="LINE110">110</td><td class="line">   current presumption (at odds which Hoare logic, in which one can only weaken </td></tr>
<tr><td class="num" id="LINE111">111</td><td class="line">   the current precondition). Specifically, from x &gt; 2 we conjoin x &gt; 0 to obtain </td></tr>
<tr><td class="num" id="LINE112">112</td><td class="line">   x &gt; 2 &amp;&amp; x &gt; 0. We then let x &gt; 2 be the frame and execute the function, to obtain </td></tr>
<tr><td class="num" id="LINE113">113</td><td class="line">   x &gt; 1 &amp;&amp; x &gt; 2 &amp;&amp; x &gt; 0. The final covers is satisfied because x == 5 ==&gt; x &gt; 2. */ </td></tr>
<tr><td class="num" id="LINE114">114</td><td class="line">void test_conseq2(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test_conseq2.dd124e48a9dde7c7c6849dda179d4818_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:3 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test_conseq2.dd124e48a9dde7c7c6849dda179d4818.html">summary for test_conseq2</a></td></tr>
<tr><td class="num" id="LINE115">115</td><td class="line">  _(presumes x &gt; 2 covers x == 5) </td></tr>
<tr><td class="num" id="LINE116">116</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE117">117</td><td class="line">  test_conseq(x); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test_conseq2.dd124e48a9dde7c7c6849dda179d4818_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:1 succs:2 exn: Instructions
n$0=*&amp;x:int [line 117, column 15];
n$1=_fun_test_conseq(n$0:int) [line 117, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE118">118</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test_conseq2.dd124e48a9dde7c7c6849dda179d4818_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE119">119</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE120">120</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE121">121</td><td class="line">/* the first contract is what one would expect to characterise the path through this </td></tr>
<tr><td class="num" id="LINE122">122</td><td class="line">   function in which it returns 1. </td></tr>
<tr><td class="num" id="LINE123">123</td><td class="line">   The second contract is an insecurity contract stating that this function is insecure and </td></tr>
<tr><td class="num" id="LINE124">124</td><td class="line">   leaks the value of (b &gt; 0) to the attacker (by branching on it) */ </td></tr>
<tr><td class="num" id="LINE125">125</td><td class="line">int test1(int b) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test1.5a105e8b9d40e1329780d62ea2265d8a.html">summary for test1</a></td></tr>
<tr><td class="num" id="LINE126">126</td><td class="line">  _(presumes true covers b &gt; 0 &amp;&amp; result == 1) </td></tr>
<tr><td class="num" id="LINE127">127</td><td class="line">  _(presumes true fails insecure (b &gt; 0) :!: attacker)   </td></tr>
<tr><td class="num" id="LINE128">128</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE129">129</td><td class="line">  if (b &gt; 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:6 7 exn: Instructions
n$0=*&amp;b:int [line 129, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:8 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 129, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:9 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 129, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds: succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE130">130</td><td class="line">    return 1; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:2 exn: Instructions
*&amp;return:int=1 [line 130, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE131">131</td><td class="line">  }else{ </td></tr>
<tr><td class="num" id="LINE132">132</td><td class="line">    return 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:7 succs:2 exn: Instructions
*&amp;return:int=0 [line 132, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE133">133</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE134">134</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test1.5a105e8b9d40e1329780d62ea2265d8a_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:9 8 4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE135">135</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE136">136</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE137">137</td><td class="line">/* This function is likewise insecure, even if the attacker is allowed to know whether </td></tr>
<tr><td class="num" id="LINE138">138</td><td class="line">   (b &gt; 0) since on the second loop iteration is leaks (b - 1 &gt; 0) which might contain more </td></tr>
<tr><td class="num" id="LINE139">139</td><td class="line">   information than b &gt; 0 (e.g. consider two initial values for b being 1 and 2). </td></tr>
<tr><td class="num" id="LINE140">140</td><td class="line">   Note that for two values of b that are not &gt; 0, (b - 1 &gt; 0) :: attacker. Hence, </td></tr>
<tr><td class="num" id="LINE141">141</td><td class="line">    (b &gt; 0) :: attacker &amp;&amp; (b - 1 &gt; 0) :!: attacker implies that b &gt; 0 holds. Hence </td></tr>
<tr><td class="num" id="LINE142">142</td><td class="line">   we do not need to say that explicitly in the result assertion (covers) here */ </td></tr>
<tr><td class="num" id="LINE143">143</td><td class="line">int test2(int b) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test2.ad0234829205b9033196ba818f7a872b.html">summary for test2</a></td></tr>
<tr><td class="num" id="LINE144">144</td><td class="line">  _(presumes true fails insecure (b &gt; 0) &amp;&amp; (b - 1 &gt; 0) :!: attacker) </td></tr>
<tr><td class="num" id="LINE145">145</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE146">146</td><td class="line">  while (b &gt; 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node5.html"><span class='visited with_tooltip'>J_5<span class='tooltip'>node5 preds:1 9 succs:6 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node6.html"><span class='visited with_tooltip'>I_6<span class='tooltip'>node6 preds:5 succs:7 8 exn: Instructions
n$1=*&amp;b:int [line 146, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:6 succs:9 exn: Conditional true Branch
PRUNE((n$1  &gt;  0), true); [line 146, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node8.html"><span class='visited with_tooltip'>C_8<span class='tooltip'>node8 preds:6 succs:3 exn: Conditional false Branch
PRUNE(!(n$1  &gt;  0), false); [line 146, column 10];
</span></span></a></td></tr>
<tr><td class="num" id="LINE147">147</td><td class="line">    b--; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:7 succs:5 exn: Instructions
n$2=*&amp;b:int [line 147, column 5];
*&amp;b:int=(n$2 - 1) [line 147, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE148">148</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE149">149</td><td class="line">  return b; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:8 succs:4 exn: Instructions
n$0=*&amp;b:int [line 149, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
*&amp;return:int=n$0 [line 149, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE150">150</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test2.ad0234829205b9033196ba818f7a872b_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE151">151</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE152">152</td><td class="line">/* At present in Underflow each result assertion can refer to only path, hence the commented-out </td></tr>
<tr><td class="num" id="LINE153">153</td><td class="line">   contract below does not hold and instead we need to specify two separate ones. */ </td></tr>
<tr><td class="num" id="LINE154">154</td><td class="line">int test3(int b) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test3.8ad8757baa8564dc136c1e07507f4a98.html">summary for test3</a></td></tr>
<tr><td class="num" id="LINE155">155</td><td class="line">//_(presumes true covers (b &gt; 0) :: low &amp;&amp; (result == 0 || result == 1)) </td></tr>
<tr><td class="num" id="LINE156">156</td><td class="line">  _(presumes true covers b &gt; 0 &amp;&amp; result == 1) </td></tr>
<tr><td class="num" id="LINE157">157</td><td class="line">  _(presumes true covers b &lt;= 0 &amp;&amp; result == 0) </td></tr>
<tr><td class="num" id="LINE158">158</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE159">159</td><td class="line">  if(b &gt; 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:6 7 exn: Instructions
n$0=*&amp;b:int [line 159, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:8 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 159, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:9 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 159, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds: succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE160">160</td><td class="line">    return 1; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:2 exn: Instructions
*&amp;return:int=1 [line 160, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE161">161</td><td class="line">  }else{ </td></tr>
<tr><td class="num" id="LINE162">162</td><td class="line">    return 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:7 succs:2 exn: Instructions
*&amp;return:int=0 [line 162, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE163">163</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE164">164</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test3.8ad8757baa8564dc136c1e07507f4a98_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:9 8 4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE165">165</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE166">166</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE167">167</td><td class="line">/* changing the covers to result == 1 gives the error that that case </td></tr>
<tr><td class="num" id="LINE168">168</td><td class="line">   is unreachable */ </td></tr>
<tr><td class="num" id="LINE169">169</td><td class="line">int test4() <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 6 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test4.86985e105f79b95d6bc918fb45ec7727.html">summary for test4</a></td></tr>
<tr><td class="num" id="LINE170">170</td><td class="line">  _(presumes true covers result == 0) </td></tr>
<tr><td class="num" id="LINE171">171</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE172">172</td><td class="line">  if (0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:1 succs:7 exn: Conditional true Branch
PRUNE(0, true); [line 172, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:1 succs:4 exn: Conditional false Branch
PRUNE(!0, false); [line 172, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node4.html"><span class='visited with_tooltip'>J_4<span class='tooltip'>node4 preds:6 succs:3 exn: Join
</span></span></a></td></tr>
<tr><td class="num" id="LINE173">173</td><td class="line">    return 1; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node7.html"><span class='visited with_tooltip'>I_7<span class='tooltip'>node7 preds:5 succs:2 exn: Instructions
*&amp;return:int=1 [line 173, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE174">174</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE175">175</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE176">176</td><td class="line">  return 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
*&amp;return:int=0 [line 176, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE177">177</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test4.86985e105f79b95d6bc918fb45ec7727_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:7 3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE178">178</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE179">179</td><td class="line">/* there are two possibilities for this function that we can express:  </td></tr>
<tr><td class="num" id="LINE180">180</td><td class="line">   (1) either it immediately finishes (x == 0), or </td></tr>
<tr><td class="num" id="LINE181">181</td><td class="line">   (2) it immediately leaks information. </td></tr>
<tr><td class="num" id="LINE182">182</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE183">183</td><td class="line">   The third commented-out contract does not hold because there exists no final </td></tr>
<tr><td class="num" id="LINE184">184</td><td class="line">   consistent state implied by x != 0. </td></tr>
<tr><td class="num" id="LINE185">185</td><td class="line">*/   </td></tr>
<tr><td class="num" id="LINE186">186</td><td class="line">void run_forever(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever.ed9f4ee57e7978d096bf9f684e79e261_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:3 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/run_forever.ed9f4ee57e7978d096bf9f684e79e261.html">summary for run_forever</a></td></tr>
<tr><td class="num" id="LINE187">187</td><td class="line">  _(presumes true covers x == 0) </td></tr>
<tr><td class="num" id="LINE188">188</td><td class="line">  _(presumes true fails insecure (x == 0) :!: attacker) </td></tr>
<tr><td class="num" id="LINE189">189</td><td class="line">//_(presumes true covers x != 0) </td></tr>
<tr><td class="num" id="LINE190">190</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE191">191</td><td class="line">  while(x){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever.ed9f4ee57e7978d096bf9f684e79e261_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:1 4 succs:4 5 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever.ed9f4ee57e7978d096bf9f684e79e261_node4.html"><span class='visited with_tooltip'>C_4<span class='tooltip'>node4 preds:3 succs:3 exn: Conditional true Branch
n$0=*&amp;x:int [line 191, column 9];
PRUNE(n$0, true); [line 191, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever.ed9f4ee57e7978d096bf9f684e79e261_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:3 succs:2 exn: Conditional false Branch
n$0=*&amp;x:int [line 191, column 9];
PRUNE(!n$0, false); [line 191, column 9];
</span></span></a></td></tr>
<tr><td class="num" id="LINE192">192</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE193">193</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever.ed9f4ee57e7978d096bf9f684e79e261_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:5 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE194">194</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE195">195</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE196">196</td><td class="line">/* this function is behaves insecurely whenever (x == 0) is not known to the attacker, </td></tr>
<tr><td class="num" id="LINE197">197</td><td class="line">   because it leaks that information. */ </td></tr>
<tr><td class="num" id="LINE198">198</td><td class="line">int run_forever2(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:3 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/run_forever2.186b099becfe3949963b8ecc5e8079e3.html">summary for run_forever2</a></td></tr>
<tr><td class="num" id="LINE199">199</td><td class="line">  _(presumes true fails insecure (x == 0) :!: attacker) </td></tr>
<tr><td class="num" id="LINE200">200</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE201">201</td><td class="line">  while(1){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:1 6 succs:4 5 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node4.html"><span class='visited with_tooltip'>C_4<span class='tooltip'>node4 preds:3 succs:7 8 exn: Conditional true Branch
PRUNE(1, true); [line 201, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:3 succs:2 exn: Conditional false Branch
PRUNE(!1, false); [line 201, column 9];
</span></span></a></td></tr>
<tr><td class="num" id="LINE202">202</td><td class="line">    if (x){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:4 succs:6 exn: Conditional true Branch
n$0=*&amp;x:int [line 202, column 9];
PRUNE(n$0, true); [line 202, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node8.html"><span class='visited with_tooltip'>C_8<span class='tooltip'>node8 preds:4 succs:6 exn: Conditional false Branch
n$0=*&amp;x:int [line 202, column 9];
PRUNE(!n$0, false); [line 202, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node6.html"><span class='visited with_tooltip'>J_6<span class='tooltip'>node6 preds:8 7 succs:3 exn: Join
</span></span></a></td></tr>
<tr><td class="num" id="LINE203">203</td><td class="line">    } </td></tr>
<tr><td class="num" id="LINE204">204</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE205">205</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/run_forever2.186b099becfe3949963b8ecc5e8079e3_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:5 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE206">206</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE207">207</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE208">208</td><td class="line">/* a few memory safety examples, since InsecSL also detects memory </td></tr>
<tr><td class="num" id="LINE209">209</td><td class="line">   safety problems, similarly to how Incorrectness Separation Logic </td></tr>
<tr><td class="num" id="LINE210">210</td><td class="line">   (ISL) does. The contract for the `free` function says that it will </td></tr>
<tr><td class="num" id="LINE211">211</td><td class="line">   run successfully if given a valid pointer and, afterwards, the </td></tr>
<tr><td class="num" id="LINE212">212</td><td class="line">   pointer will be invalid. However it will fail with a memory error </td></tr>
<tr><td class="num" id="LINE213">213</td><td class="line">   if the given pointer is invalid. */ </td></tr>
<tr><td class="num" id="LINE214">214</td><td class="line">void free(int * p); </td></tr>
<tr><td class="num" id="LINE215">215</td><td class="line">  _(presumes exists int v. p |-&gt; v covers p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE216">216</td><td class="line">  _(presumes p |-\-&gt; fails memory p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE217">217</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE218">218</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE219">219</td><td class="line">void do_free(int * p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free.9d955d8a76b5f44d3c1f2109ec27d23b_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:3 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/do_free.9d955d8a76b5f44d3c1f2109ec27d23b.html">summary for do_free</a></td></tr>
<tr><td class="num" id="LINE220">220</td><td class="line">  _(presumes exists int v. p |-&gt; v covers (p + 0) |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE221">221</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE222">222</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free.9d955d8a76b5f44d3c1f2109ec27d23b_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:1 succs:2 exn: Instructions
n$0=*&amp;p:int* [line 222, column 8];
n$1=_fun_free(n$0:int*) [line 222, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE223">223</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free.9d955d8a76b5f44d3c1f2109ec27d23b_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE224">224</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE225">225</td><td class="line">/* detect write after free */ </td></tr>
<tr><td class="num" id="LINE226">226</td><td class="line">void do_free_use(int * p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use.411f8679fb3a8a6e9d33cdd6b0bf8cee_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/do_free_use.411f8679fb3a8a6e9d33cdd6b0bf8cee.html">summary for do_free_use</a></td></tr>
<tr><td class="num" id="LINE227">227</td><td class="line">  _(presumes exists int v. p |-&gt; v fails memory p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE228">228</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE229">229</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use.411f8679fb3a8a6e9d33cdd6b0bf8cee_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:3 exn: Instructions
n$1=*&amp;p:int* [line 229, column 8];
n$2=_fun_free(n$1:int*) [line 229, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE230">230</td><td class="line">  p[0] = 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use.411f8679fb3a8a6e9d33cdd6b0bf8cee_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;p:int* [line 230, column 3];
*n$0[0]:int=0 [line 230, column 3];
</span></span></a>
<div class="msg" style="margin-left:9ex">USE_AFTER_FREE Pulse found a potential null pointer dereference  on line 229.</div></td></tr>
<tr><td class="num" id="LINE231">231</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use.411f8679fb3a8a6e9d33cdd6b0bf8cee_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE232">232</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE233">233</td><td class="line">/* detect read after free */ </td></tr>
<tr><td class="num" id="LINE234">234</td><td class="line">void do_free_use2(int * p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use2.ff5cafdebf706a05348829a6fc990afc_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/do_free_use2.ff5cafdebf706a05348829a6fc990afc.html">summary for do_free_use2</a></td></tr>
<tr><td class="num" id="LINE235">235</td><td class="line">  _(presumes exists int v. p |-&gt; v fails memory p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE236">236</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE237">237</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use2.ff5cafdebf706a05348829a6fc990afc_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:3 exn: Instructions
n$2=*&amp;p:int* [line 237, column 8];
n$3=_fun_free(n$2:int*) [line 237, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE238">238</td><td class="line">  int x = *(p + 0); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use2.ff5cafdebf706a05348829a6fc990afc_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
VARIABLE_DECLARED(x:int); [line 238, column 3];
n$0=*&amp;p:int* [line 238, column 13];
n$1=*(n$0 + 0):int [line 238, column 11];
*&amp;x:int=n$1 [line 238, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE239">239</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/do_free_use2.ff5cafdebf706a05348829a6fc990afc_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE240">240</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE241">241</td><td class="line">/* detect double-free */ </td></tr>
<tr><td class="num" id="LINE242">242</td><td class="line">void double_free(int * p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/double_free.6d2ab36e9b0902904cdf28713b1c1480_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/double_free.6d2ab36e9b0902904cdf28713b1c1480.html">summary for double_free</a></td></tr>
<tr><td class="num" id="LINE243">243</td><td class="line">  _(presumes exists int v. p |-&gt; v fails memory p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE244">244</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE245">245</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/double_free.6d2ab36e9b0902904cdf28713b1c1480_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:3 exn: Instructions
n$2=*&amp;p:int* [line 245, column 8];
n$3=_fun_free(n$2:int*) [line 245, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE246">246</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/double_free.6d2ab36e9b0902904cdf28713b1c1480_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;p:int* [line 246, column 8];
n$1=_fun_free(n$0:int*) [line 246, column 3];
</span></span></a>
<div class="msg" style="margin-left:9ex">USE_AFTER_FREE Pulse found a potential null pointer dereference  on line 245.</div></td></tr>
<tr><td class="num" id="LINE247">247</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/double_free.6d2ab36e9b0902904cdf28713b1c1480_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE248">248</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE249">249</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE250">250</td><td class="line">/* Examples from the under-approximate relational logic on IMP,  </td></tr>
<tr><td class="num" id="LINE251">251</td><td class="line">   originally inspired by examples in O'Hearn, PACMPL 2019 (POPL 2020) */ </td></tr>
<tr><td class="num" id="LINE252">252</td><td class="line">int get_y(int n); </td></tr>
<tr><td class="num" id="LINE253">253</td><td class="line">  _(presumes true covers result :: low &amp;&amp; n :: low &amp;&amp; n &gt; 0) </td></tr>
<tr><td class="num" id="LINE254">254</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE255">255</td><td class="line">/* mimics the command to output on the low channel. Its contract says </td></tr>
<tr><td class="num" id="LINE256">256</td><td class="line">   that calling this function is insecure if the argument is not low </td></tr>
<tr><td class="num" id="LINE257">257</td><td class="line">   (i.e. not known to the low attacker). We specify this using the </td></tr>
<tr><td class="num" id="LINE258">258</td><td class="line">   /insecurity/ assertion :!:. Just as |-\-&gt; is the invalid </td></tr>
<tr><td class="num" id="LINE259">259</td><td class="line">   counterpart to |-&gt;, :!: is the invalid counterpart to ::, the </td></tr>
<tr><td class="num" id="LINE260">260</td><td class="line">   security assertion.  </td></tr>
<tr><td class="num" id="LINE261">261</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE262">262</td><td class="line">   Remember that non-spatial assertions in the 'covers / fails' part should be </td></tr>
<tr><td class="num" id="LINE263">263</td><td class="line">   read as &quot;preconditions&quot; */ </td></tr>
<tr><td class="num" id="LINE264">264</td><td class="line">void output_low(int x); </td></tr>
<tr><td class="num" id="LINE265">265</td><td class="line">  _(presumes true fails insecure x :!: low) </td></tr>
<tr><td class="num" id="LINE266">266</td><td class="line">  _(presumes true covers x :: low) </td></tr>
<tr><td class="num" id="LINE267">267</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE268">268</td><td class="line">/* the insecurity of this example can be demonstrated by unfolding the </td></tr>
<tr><td class="num" id="LINE269">269</td><td class="line">   loop just once, when the non-low value h is output to the low </td></tr>
<tr><td class="num" id="LINE270">270</td><td class="line">   attacker, when n was initially 2000000 */ </td></tr>
<tr><td class="num" id="LINE271">271</td><td class="line">void example2(int n, int h) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:15 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/example2.66b375b08fc869632935c9e6a9c7f8da.html">summary for example2</a></td></tr>
<tr><td class="num" id="LINE272">272</td><td class="line">  _(presumes true fails insecure n == 2000000 &amp;&amp; h :!: low) </td></tr>
<tr><td class="num" id="LINE273">273</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE274">274</td><td class="line">  int x = 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node15.html"><span class='visited with_tooltip'>I_15<span class='tooltip'>node15 preds:1 succs:9 exn: Instructions
VARIABLE_DECLARED(x:int); [line 274, column 3];
*&amp;x:int=0 [line 274, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE275">275</td><td class="line">  while (n &gt; 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node9.html"><span class='visited with_tooltip'>J_9<span class='tooltip'>node9 preds:15 13 succs:10 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node10.html"><span class='visited with_tooltip'>I_10<span class='tooltip'>node10 preds:9 succs:11 12 exn: Instructions
n$5=*&amp;n:int [line 275, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node11.html"><span class='visited with_tooltip'>C_11<span class='tooltip'>node11 preds:10 succs:14 exn: Conditional true Branch
PRUNE((n$5  &gt;  0), true); [line 275, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node12.html"><span class='visited with_tooltip'>C_12<span class='tooltip'>node12 preds:10 succs:5 exn: Conditional false Branch
PRUNE(!(n$5  &gt;  0), false); [line 275, column 10];
</span></span></a></td></tr>
<tr><td class="num" id="LINE276">276</td><td class="line">    x = x + n; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node14.html"><span class='visited with_tooltip'>I_14<span class='tooltip'>node14 preds:11 succs:13 exn: Instructions
n$8=*&amp;x:int [line 276, column 9];
n$9=*&amp;n:int [line 276, column 13];
*&amp;x:int=(n$8 + n$9) [line 276, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE277">277</td><td class="line">    n = get_y(n); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node13.html"><span class='visited with_tooltip'>I_13<span class='tooltip'>node13 preds:14 succs:9 exn: Instructions
n$6=*&amp;n:int [line 277, column 15];
n$7=_fun_get_y(n$6:int) [line 277, column 9];
*&amp;n:int=n$7 [line 277, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE278">278</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE279">279</td><td class="line">  if (x == 2000000){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:12 succs:6 7 exn: Instructions
n$0=*&amp;x:int [line 279, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:8 exn: Conditional true Branch
PRUNE((n$0 == 2000000), true); [line 279, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:3 exn: Conditional false Branch
PRUNE(!(n$0 == 2000000), false); [line 279, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:7 8 succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE280">280</td><td class="line">    output_low(h); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:3 exn: Instructions
n$1=*&amp;h:int [line 280, column 16];
n$2=_fun_output_low(n$1:int) [line 280, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE281">281</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE282">282</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2.66b375b08fc869632935c9e6a9c7f8da_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE283">283</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE284">284</td><td class="line">/* this example does not demonstrate insecurity (under the contract </td></tr>
<tr><td class="num" id="LINE285">285</td><td class="line">   for get_y above), since then we can conclude that the loop guard n </td></tr>
<tr><td class="num" id="LINE286">286</td><td class="line">   is always low and x is always low, hence the if-condition and  </td></tr>
<tr><td class="num" id="LINE287">287</td><td class="line">   outputting x are both secure. */ </td></tr>
<tr><td class="num" id="LINE288">288</td><td class="line">void example2_secure(int n) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:15 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce.html">summary for example2_secure</a></td></tr>
<tr><td class="num" id="LINE289">289</td><td class="line">  _(presumes true covers n == 2000000) </td></tr>
<tr><td class="num" id="LINE290">290</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE291">291</td><td class="line">  int x = 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node15.html"><span class='visited with_tooltip'>I_15<span class='tooltip'>node15 preds:1 succs:9 exn: Instructions
VARIABLE_DECLARED(x:int); [line 291, column 3];
*&amp;x:int=0 [line 291, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE292">292</td><td class="line">  while (n &gt; 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node9.html"><span class='visited with_tooltip'>J_9<span class='tooltip'>node9 preds:15 13 succs:10 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node10.html"><span class='visited with_tooltip'>I_10<span class='tooltip'>node10 preds:9 succs:11 12 exn: Instructions
n$5=*&amp;n:int [line 292, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node11.html"><span class='visited with_tooltip'>C_11<span class='tooltip'>node11 preds:10 succs:14 exn: Conditional true Branch
PRUNE((n$5  &gt;  0), true); [line 292, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node12.html"><span class='visited with_tooltip'>C_12<span class='tooltip'>node12 preds:10 succs:5 exn: Conditional false Branch
PRUNE(!(n$5  &gt;  0), false); [line 292, column 10];
</span></span></a></td></tr>
<tr><td class="num" id="LINE293">293</td><td class="line">    x = x + n; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node14.html"><span class='visited with_tooltip'>I_14<span class='tooltip'>node14 preds:11 succs:13 exn: Instructions
n$8=*&amp;x:int [line 293, column 9];
n$9=*&amp;n:int [line 293, column 13];
*&amp;x:int=(n$8 + n$9) [line 293, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE294">294</td><td class="line">    n = get_y(n); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node13.html"><span class='visited with_tooltip'>I_13<span class='tooltip'>node13 preds:14 succs:9 exn: Instructions
n$6=*&amp;n:int [line 294, column 15];
n$7=_fun_get_y(n$6:int) [line 294, column 9];
*&amp;n:int=n$7 [line 294, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE295">295</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE296">296</td><td class="line">  if (x == 2000000){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:12 succs:6 7 exn: Instructions
n$0=*&amp;x:int [line 296, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:8 exn: Conditional true Branch
PRUNE((n$0 == 2000000), true); [line 296, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:3 exn: Conditional false Branch
PRUNE(!(n$0 == 2000000), false); [line 296, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:7 8 succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE297">297</td><td class="line">    output_low(x); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:3 exn: Instructions
n$1=*&amp;x:int [line 297, column 16];
n$2=_fun_output_low(n$1:int) [line 297, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE298">298</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE299">299</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/example2_secure.cee941715c400ce2b0dbb7c4fdba45ce_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE300">300</td><td class="line">void load_and_output(int *p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output.d5333cfb7d983fe661cac48c11a4173b_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/load_and_output.d5333cfb7d983fe661cac48c11a4173b.html">summary for load_and_output</a></td></tr>
<tr><td class="num" id="LINE301">301</td><td class="line">  _(presumes exists int v2. p |-&gt; v2 covers exists int v. p |-&gt; v &amp;*&amp; v :: low) </td></tr>
<tr><td class="num" id="LINE302">302</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE303">303</td><td class="line">  int x = *p; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output.d5333cfb7d983fe661cac48c11a4173b_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:3 exn: Instructions
VARIABLE_DECLARED(x:int); [line 303, column 3];
n$2=*&amp;p:int* [line 303, column 12];
n$3=*n$2:int [line 303, column 11];
*&amp;x:int=n$3 [line 303, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE304">304</td><td class="line">  output_low(x); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output.d5333cfb7d983fe661cac48c11a4173b_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;x:int [line 304, column 14];
n$1=_fun_output_low(n$0:int) [line 304, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE305">305</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output.d5333cfb7d983fe661cac48c11a4173b_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE306">306</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE307">307</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE308">308</td><td class="line">/* Notice how we put the information about v being low into the result. </td></tr>
<tr><td class="num" id="LINE309">309</td><td class="line">   That is totally OK since v is a logical variable, i.e. like an argument </td></tr>
<tr><td class="num" id="LINE310">310</td><td class="line">   its value once the function finishes is the same as when it began, so </td></tr>
<tr><td class="num" id="LINE311">311</td><td class="line">   knowing v :: low in the result implies we could put it into the </td></tr>
<tr><td class="num" id="LINE312">312</td><td class="line">   presumption too. </td></tr>
<tr><td class="num" id="LINE313">313</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE314">314</td><td class="line">   However in its current implementation Underflow doesn't back-propagate </td></tr>
<tr><td class="num" id="LINE315">315</td><td class="line">   the v :: low into the presumption (even when -strengthen is supplied) </td></tr>
<tr><td class="num" id="LINE316">316</td><td class="line">   because it doesn't back-propagate information obtained from the result </td></tr>
<tr><td class="num" id="LINE317">317</td><td class="line">   of a callee (like output_low() in this case, where v :: low comes from) </td></tr>
<tr><td class="num" id="LINE318">318</td><td class="line">*/ </td></tr>
<tr><td class="num" id="LINE319">319</td><td class="line">void load_and_output_and_zero(int *p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output_and_zero.e3f1e871bc3388a987b771a36e6a9ddd_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/load_and_output_and_zero.e3f1e871bc3388a987b771a36e6a9ddd.html">summary for load_and_output_and_zero</a></td></tr>
<tr><td class="num" id="LINE320">320</td><td class="line">  _(presumes exists int v. p |-&gt; v covers p |-&gt; 0 &amp;*&amp; v :: low) </td></tr>
<tr><td class="num" id="LINE321">321</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE322">322</td><td class="line">  int x = *p; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output_and_zero.e3f1e871bc3388a987b771a36e6a9ddd_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:4 exn: Instructions
VARIABLE_DECLARED(x:int); [line 322, column 3];
n$3=*&amp;p:int* [line 322, column 12];
n$4=*n$3:int [line 322, column 11];
*&amp;x:int=n$4 [line 322, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE323">323</td><td class="line">  output_low(x); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output_and_zero.e3f1e871bc3388a987b771a36e6a9ddd_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:5 succs:3 exn: Instructions
n$1=*&amp;x:int [line 323, column 14];
n$2=_fun_output_low(n$1:int) [line 323, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE324">324</td><td class="line">  *p = 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output_and_zero.e3f1e871bc3388a987b771a36e6a9ddd_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;p:int* [line 324, column 4];
*n$0:int=0 [line 324, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE325">325</td><td class="line">  // ...  other stuff here ... </td></tr>
<tr><td class="num" id="LINE326">326</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_output_and_zero.e3f1e871bc3388a987b771a36e6a9ddd_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE327">327</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE328">328</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE329">329</td><td class="line">/* a false negative due to under-approximation. To detect this </td></tr>
<tr><td class="num" id="LINE330">330</td><td class="line">   we would need to implement a version of the backwards variant </td></tr>
<tr><td class="num" id="LINE331">331</td><td class="line">   rule and allow the user to supply (or automatically infer) the </td></tr>
<tr><td class="num" id="LINE332">332</td><td class="line">   backwards variant (or unroll the loop four million times)  </td></tr>
<tr><td class="num" id="LINE333">333</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE334">334</td><td class="line">   Note that the trivial contract below is not currently validated </td></tr>
<tr><td class="num" id="LINE335">335</td><td class="line">   because Underflow regards any contract as false when it cannot find </td></tr>
<tr><td class="num" id="LINE336">336</td><td class="line">   any consistent result state, even if the result assertion itself is </td></tr>
<tr><td class="num" id="LINE337">337</td><td class="line">   unsatisfiable. That limitation we might remove in future. */ </td></tr>
<tr><td class="num" id="LINE338">338</td><td class="line">void false_negative(int high) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:13 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/false_negative.9022b22d09cf12b8f07fccab43ec8763.html">summary for false_negative</a></td></tr>
<tr><td class="num" id="LINE339">339</td><td class="line">//_(presumes true covers false) </td></tr>
<tr><td class="num" id="LINE340">340</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE341">341</td><td class="line">  int x = 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node13.html"><span class='visited with_tooltip'>I_13<span class='tooltip'>node13 preds:1 succs:3 exn: Instructions
VARIABLE_DECLARED(x:int); [line 341, column 3];
*&amp;x:int=0 [line 341, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE342">342</td><td class="line">  while (x &lt; 4000000){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:13 7 succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:5 6 exn: Instructions
n$0=*&amp;x:int [line 342, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:4 succs:12 exn: Conditional true Branch
PRUNE((n$0  &lt;  4000000), true); [line 342, column 10];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:4 succs:2 exn: Conditional false Branch
PRUNE(!(n$0  &lt;  4000000), false); [line 342, column 10];
</span></span></a></td></tr>
<tr><td class="num" id="LINE343">343</td><td class="line">    x++; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node12.html"><span class='visited with_tooltip'>I_12<span class='tooltip'>node12 preds:5 succs:8 exn: Instructions
n$6=*&amp;x:int [line 343, column 5];
*&amp;x:int=(n$6 + 1) [line 343, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE344">344</td><td class="line">    if (x == 2000000){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:12 succs:9 10 exn: Instructions
n$1=*&amp;x:int [line 344, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node9.html"><span class='visited with_tooltip'>C_9<span class='tooltip'>node9 preds:8 succs:11 exn: Conditional true Branch
PRUNE((n$1 == 2000000), true); [line 344, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node10.html"><span class='visited with_tooltip'>C_10<span class='tooltip'>node10 preds:8 succs:7 exn: Conditional false Branch
PRUNE(!(n$1 == 2000000), false); [line 344, column 9];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node7.html"><span class='visited with_tooltip'>J_7<span class='tooltip'>node7 preds:10 11 succs:3 exn: Join
</span></span></a></td></tr>
<tr><td class="num" id="LINE345">345</td><td class="line">      output_low(high); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node11.html"><span class='visited with_tooltip'>I_11<span class='tooltip'>node11 preds:9 succs:7 exn: Instructions
n$2=*&amp;high:int [line 345, column 18];
n$3=_fun_output_low(n$2:int) [line 345, column 7];
</span></span></a></td></tr>
<tr><td class="num" id="LINE346">346</td><td class="line">    } </td></tr>
<tr><td class="num" id="LINE347">347</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE348">348</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/false_negative.9022b22d09cf12b8f07fccab43ec8763_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:6 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE349">349</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE350">350</td><td class="line">/* This example /rightly/ has an assertion violation.  This was very </td></tr>
<tr><td class="num" id="LINE351">351</td><td class="line">   surprising to me but (after extracting the model from Z3) the </td></tr>
<tr><td class="num" id="LINE352">352</td><td class="line">   reason has to do with the meaning of x &gt; 0 ? (x &gt; 0)::low : </td></tr>
<tr><td class="num" id="LINE353">353</td><td class="line">   (x&gt;0)::low There are two cases: the first case is when x &gt; 0 is </td></tr>
<tr><td class="num" id="LINE354">354</td><td class="line">   true. This means that x &gt; 0 holds in both states. In that case of </td></tr>
<tr><td class="num" id="LINE355">355</td><td class="line">   course (x &gt; 0)::low holds.  The other case is when x &gt; 0 is not </td></tr>
<tr><td class="num" id="LINE356">356</td><td class="line">   true. Note that is /not/ the same as !(x&gt;0) being true. The former </td></tr>
<tr><td class="num" id="LINE357">357</td><td class="line">   just means that x &gt; 0 does not evaluate true in both states.  In </td></tr>
<tr><td class="num" id="LINE358">358</td><td class="line">   that case it is not true that (x &gt; 0)::low holds. So the negation </td></tr>
<tr><td class="num" id="LINE359">359</td><td class="line">   of the assertion is rightly satisfiable */ </td></tr>
<tr><td class="num" id="LINE360">360</td><td class="line">int curious(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/curious.821ae63dbe0c573eff8b69d451fb21bc.html">summary for curious</a></td></tr>
<tr><td class="num" id="LINE361">361</td><td class="line">  _(presumes true fails assertion !((x &gt; 0)?(x &gt; 0)::low:(x&gt;0)::low)) </td></tr>
<tr><td class="num" id="LINE362">362</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE363">363</td><td class="line">  _(assert ((x &gt; 0)?(x &gt; 0)::low:(x&gt;0)::low)) </td></tr>
<tr><td class="num" id="LINE364">364</td><td class="line">  return (x &gt; 0); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:5 6 exn: Instructions
n$0=*&amp;x:int [line 364, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:4 succs:7 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 364, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node7.html"><span class='visited with_tooltip'>I_7<span class='tooltip'>node7 preds:5 succs:3 exn: Instructions
*&amp;return:int=1 [line 364, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:4 succs:8 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 364, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:3 exn: Instructions
*&amp;return:int=0 [line 364, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:8 7 succs:9 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE365">365</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious.821ae63dbe0c573eff8b69d451fb21bc_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:9 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE366">366</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE367">367</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE368">368</td><td class="line">/* Note, however, that this function does /not/ have a violated </td></tr>
<tr><td class="num" id="LINE369">369</td><td class="line">   assert, despite the above discussion. The reason is because  </td></tr>
<tr><td class="num" id="LINE370">370</td><td class="line">   (x &gt; 0) ? (x &gt; 0) : (!(x&gt;0)) is interpreted as a pure  </td></tr>
<tr><td class="num" id="LINE371">371</td><td class="line">   (non-relational) condition  and so it holds when it holds in  </td></tr>
<tr><td class="num" id="LINE372">372</td><td class="line">   both states individually, which of course it does. In other </td></tr>
<tr><td class="num" id="LINE373">373</td><td class="line">   words the assertion is a tautology. */ </td></tr>
<tr><td class="num" id="LINE374">374</td><td class="line">int curious_no_violated_assert(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693.html">summary for curious_no_violated_assert</a></td></tr>
<tr><td class="num" id="LINE375">375</td><td class="line">  _(presumes true covers result == (x &gt; 0)) </td></tr>
<tr><td class="num" id="LINE376">376</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE377">377</td><td class="line">  _(assert ((x &gt; 0)?(x &gt; 0):(!(x&gt;0)))) </td></tr>
<tr><td class="num" id="LINE378">378</td><td class="line">  return (x &gt; 0); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:5 6 exn: Instructions
n$0=*&amp;x:int [line 378, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:4 succs:7 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 378, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node7.html"><span class='visited with_tooltip'>I_7<span class='tooltip'>node7 preds:5 succs:3 exn: Instructions
*&amp;return:int=1 [line 378, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:4 succs:8 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 378, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:3 exn: Instructions
*&amp;return:int=0 [line 378, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:8 7 succs:9 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE379">379</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert.cf7a41bc5e5bc3a68c34cb6abfb05693_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:9 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE380">380</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE381">381</td><td class="line">/* this one has no violated assert (although it is insecure). The </td></tr>
<tr><td class="num" id="LINE382">382</td><td class="line">   reason is because by nature it only considers the two cases in </td></tr>
<tr><td class="num" id="LINE383">383</td><td class="line">   which x &gt; 0 is either true in both states or is false in both </td></tr>
<tr><td class="num" id="LINE384">384</td><td class="line">   states. */ </td></tr>
<tr><td class="num" id="LINE385">385</td><td class="line">int curious_no_violated_assert2(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:11 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d.html">summary for curious_no_violated_assert2</a></td></tr>
<tr><td class="num" id="LINE386">386</td><td class="line">  _(presumes true covers x &gt; 0 &amp;&amp; result == (x &gt; 0)) </td></tr>
<tr><td class="num" id="LINE387">387</td><td class="line">  _(presumes true covers x &lt;= 0 &amp;&amp; result == (x &gt; 0))   </td></tr>
<tr><td class="num" id="LINE388">388</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE389">389</td><td class="line">  if (x &gt; 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node11.html"><span class='visited with_tooltip'>I_11<span class='tooltip'>node11 preds:1 succs:12 13 exn: Instructions
n$1=*&amp;x:int [line 389, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node12.html"><span class='visited with_tooltip'>C_12<span class='tooltip'>node12 preds:11 succs:10 exn: Conditional true Branch
PRUNE((n$1  &gt;  0), true); [line 389, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node13.html"><span class='visited with_tooltip'>C_13<span class='tooltip'>node13 preds:11 succs:10 exn: Conditional false Branch
PRUNE(!(n$1  &gt;  0), false); [line 389, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node10.html"><span class='visited with_tooltip'>J_10<span class='tooltip'>node10 preds:13 12 succs:4 exn: Join
</span></span></a></td></tr>
<tr><td class="num" id="LINE390">390</td><td class="line">    _(assert (x &gt; 0)::low) </td></tr>
<tr><td class="num" id="LINE391">391</td><td class="line">  } else { </td></tr>
<tr><td class="num" id="LINE392">392</td><td class="line">    _(assert (x &gt; 0)::low) </td></tr>
<tr><td class="num" id="LINE393">393</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE394">394</td><td class="line">  return (x &gt; 0); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:10 succs:5 6 exn: Instructions
n$0=*&amp;x:int [line 394, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:4 succs:7 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 394, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node7.html"><span class='visited with_tooltip'>I_7<span class='tooltip'>node7 preds:5 succs:3 exn: Instructions
*&amp;return:int=1 [line 394, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:4 succs:8 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 394, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:3 exn: Instructions
*&amp;return:int=0 [line 394, column 11];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:8 7 succs:9 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE395">395</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/curious_no_violated_assert2.b443cb9235e1b62af3184dbb0090fc1d_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:9 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE396">396</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE397">397</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE398">398</td><td class="line">/* multiple kinds of failures, each with thier own contract. */ </td></tr>
<tr><td class="num" id="LINE399">399</td><td class="line">void error_and_insecure(int x, int *p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure.4dbf457c185e968b7bc6722c4cb1aa53_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/error_and_insecure.4dbf457c185e968b7bc6722c4cb1aa53.html">summary for error_and_insecure</a></td></tr>
<tr><td class="num" id="LINE400">400</td><td class="line">  _(presumes exists int v. p |-&gt; v covers p |-\-&gt; &amp;*&amp; x :: low) </td></tr>
<tr><td class="num" id="LINE401">401</td><td class="line">  _(presumes p |-\-&gt; fails memory p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE402">402</td><td class="line">  _(presumes exists int v. p |-&gt; v fails insecure p |-\-&gt; &amp;*&amp; x :!: low) </td></tr>
<tr><td class="num" id="LINE403">403</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE404">404</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure.4dbf457c185e968b7bc6722c4cb1aa53_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:3 exn: Instructions
n$2=*&amp;p:int* [line 404, column 8];
n$3=_fun_free(n$2:int*) [line 404, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE405">405</td><td class="line">  output_low(x); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure.4dbf457c185e968b7bc6722c4cb1aa53_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;x:int [line 405, column 14];
n$1=_fun_output_low(n$0:int) [line 405, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE406">406</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure.4dbf457c185e968b7bc6722c4cb1aa53_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE407">407</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE408">408</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE409">409</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE410">410</td><td class="line">/* The 'push-back' example from the ISL paper </td></tr>
<tr><td class="num" id="LINE411">411</td><td class="line"> * Fig 2., Raad et al., CAV 2020 </td></tr>
<tr><td class="num" id="LINE412">412</td><td class="line"> */ </td></tr>
<tr><td class="num" id="LINE413">413</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE414">414</td><td class="line">int **palloc(); </td></tr>
<tr><td class="num" id="LINE415">415</td><td class="line">_(presumes true covers exists int * p, int v. result |-&gt; p &amp;*&amp; p |-&gt; v) </td></tr>
<tr><td class="num" id="LINE416">416</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE417">417</td><td class="line">int *alloc(); </td></tr>
<tr><td class="num" id="LINE418">418</td><td class="line">_(presumes true covers exists int v. result |-&gt; v) </td></tr>
<tr><td class="num" id="LINE419">419</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE420">420</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE421">421</td><td class="line">int nondet(); </td></tr>
<tr><td class="num" id="LINE422">422</td><td class="line">_(presumes true covers result :: low) </td></tr>
<tr><td class="num" id="LINE423">423</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE424">424</td><td class="line">/* Note that variables introduced via &quot;exists&quot; in presumptions can be freely referred to </td></tr>
<tr><td class="num" id="LINE425">425</td><td class="line">   in the result, and this is Underflow's way of universally quantifying over such. */ </td></tr>
<tr><td class="num" id="LINE426">426</td><td class="line">void push_back(int **v) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/push_back.ce11ac8a6c07bc5009b0a396161d11ba.html">summary for push_back</a></td></tr>
<tr><td class="num" id="LINE427">427</td><td class="line">_(presumes exists int *p, int v2. v |-&gt; p &amp;*&amp; p |-&gt; v2 covers exists int *r, int _r. p |-\-&gt; &amp;*&amp; v |-&gt; r &amp;*&amp; r |-&gt; _r) </td></tr>
<tr><td class="num" id="LINE428">428</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE429">429</td><td class="line">  if (nondet()){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:6 7 exn: Instructions
n$0=_fun_nondet() [line 429, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:11 exn: Conditional true Branch
PRUNE(n$0, true); [line 429, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:3 exn: Conditional false Branch
PRUNE(!n$0, false); [line 429, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:7 8 succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE430">430</td><td class="line">    int *y = *v; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node11.html"><span class='visited with_tooltip'>I_11<span class='tooltip'>node11 preds:6 succs:10 exn: Instructions
VARIABLE_DECLARED(y:int*); [line 430, column 5];
n$6=*&amp;v:int** [line 430, column 15];
n$7=*n$6:int* [line 430, column 14];
*&amp;y:int*=n$7 [line 430, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE431">431</td><td class="line">    free(y); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node10.html"><span class='visited with_tooltip'>I_10<span class='tooltip'>node10 preds:11 succs:9 exn: Instructions
n$4=*&amp;y:int* [line 431, column 10];
n$5=_fun_free(n$4:int*) [line 431, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE432">432</td><td class="line">    y = alloc(); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:10 succs:8 exn: Instructions
n$3=_fun_alloc() [line 432, column 9];
*&amp;y:int*=n$3 [line 432, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE433">433</td><td class="line">    *v = y; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:9 succs:3 exn: Instructions
n$1=*&amp;v:int** [line 433, column 6];
n$2=*&amp;y:int* [line 433, column 10];
*n$1:int*=n$2 [line 433, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE434">434</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE435">435</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/push_back.ce11ac8a6c07bc5009b0a396161d11ba_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE436">436</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE437">437</td><td class="line">/* Underflow does in fact detect the failure here (use the -discover option to see it). </td></tr>
<tr><td class="num" id="LINE438">438</td><td class="line">   However there is no way for us to write the contract so that Underflow will match it </td></tr>
<tr><td class="num" id="LINE439">439</td><td class="line">   because it currently doesn't know how to match spatial assertions p |-&gt; ? or p |-\-&gt;  </td></tr>
<tr><td class="num" id="LINE440">440</td><td class="line">   in the contract's result when p is existentially quantified and is not determined by some </td></tr>
<tr><td class="num" id="LINE441">441</td><td class="line">   other points-to assertion.  */ </td></tr>
<tr><td class="num" id="LINE442">442</td><td class="line">void isl_push_back() <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/isl_push_back.7930181db634e538db145821beae7fa3_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:6 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/isl_push_back.7930181db634e538db145821beae7fa3.html">summary for isl_push_back</a></td></tr>
<tr><td class="num" id="LINE443">443</td><td class="line">//_(presumes true fails memory exists int* r, int _r, int** re, int* p. r |-&gt; _r &amp;&amp; re |-&gt; r &amp;&amp; p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE444">444</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE445">445</td><td class="line">    int **v = palloc(); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/isl_push_back.7930181db634e538db145821beae7fa3_node6.html"><span class='visited with_tooltip'>I_6<span class='tooltip'>node6 preds:1 succs:5 exn: Instructions
VARIABLE_DECLARED(v:int**); [line 445, column 5];
n$5=_fun_palloc() [line 445, column 15];
*&amp;v:int**=n$5 [line 445, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE446">446</td><td class="line">    int *x = *v; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/isl_push_back.7930181db634e538db145821beae7fa3_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:6 succs:4 exn: Instructions
VARIABLE_DECLARED(x:int*); [line 446, column 5];
n$3=*&amp;v:int** [line 446, column 15];
n$4=*n$3:int* [line 446, column 14];
*&amp;x:int*=n$4 [line 446, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE447">447</td><td class="line">    push_back(v); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/isl_push_back.7930181db634e538db145821beae7fa3_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:5 succs:3 exn: Instructions
n$1=*&amp;v:int** [line 447, column 15];
n$2=_fun_push_back(n$1:int**) [line 447, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE448">448</td><td class="line">    *x = 88; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/isl_push_back.7930181db634e538db145821beae7fa3_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;x:int* [line 448, column 6];
*n$0:int=88 [line 448, column 5];
</span></span></a>
<div class="msg" style="margin-left:9ex">USE_AFTER_FREE Pulse found a potential null pointer dereference  on line 447 indirectly during the call to `push_back()`.</div></td></tr>
<tr><td class="num" id="LINE449">449</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/isl_push_back.7930181db634e538db145821beae7fa3_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE450">450</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE451">451</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE452">452</td><td class="line">/* The following commented covers illustrates a limitation of Underflow's current </td></tr>
<tr><td class="num" id="LINE453">453</td><td class="line">   design. Note that the contract below is met by this function: for </td></tr>
<tr><td class="num" id="LINE454">454</td><td class="line">   all final states in which b &lt; 5, there exists an initial state </td></tr>
<tr><td class="num" id="LINE455">455</td><td class="line">   identical to that final one in which the final state can be reached </td></tr>
<tr><td class="num" id="LINE456">456</td><td class="line">   by running this function. </td></tr>
<tr><td class="num" id="LINE457">457</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE458">458</td><td class="line">   However Underflow cannot determine this. The reason is because the </td></tr>
<tr><td class="num" id="LINE459">459</td><td class="line">   if-statement causes it to fork the execution and the final contract </td></tr>
<tr><td class="num" id="LINE460">460</td><td class="line">   is evaluated against each final state individually (rather than e.g. taking </td></tr>
<tr><td class="num" id="LINE461">461</td><td class="line">   the disjunction of all final states and evaluating the contract against </td></tr>
<tr><td class="num" id="LINE462">462</td><td class="line">   that). </td></tr>
<tr><td class="num" id="LINE463">463</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE464">464</td><td class="line">   Specifically, the current Underflow implementation says the contract is </td></tr>
<tr><td class="num" id="LINE465">465</td><td class="line">   satisfied only when one of the following two conditions hold: </td></tr>
<tr><td class="num" id="LINE466">466</td><td class="line">   (1) b &gt; 0     &lt;==    b &lt; 5  </td></tr>
<tr><td class="num" id="LINE467">467</td><td class="line">   (1) b &lt;= 0    &lt;==    b &lt; 5 </td></tr>
<tr><td class="num" id="LINE468">468</td><td class="line">   Of course neither of them do. However if we took the disjunction of the </td></tr>
<tr><td class="num" id="LINE469">469</td><td class="line">   final states we would instead have to prove: </td></tr>
<tr><td class="num" id="LINE470">470</td><td class="line">   (*) b &gt; 0  || b &lt;= 0    &lt;==    </td></tr>
<tr><td class="num" id="LINE471">471</td><td class="line">       b &lt; 5  </td></tr>
<tr><td class="num" id="LINE472">472</td><td class="line">   which does hold. </td></tr>
<tr><td class="num" id="LINE473">473</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE474">474</td><td class="line">   We leave it as future work to extend Underflow's implementation to handle </td></tr>
<tr><td class="num" id="LINE475">475</td><td class="line">   proving these kinds of contracts. </td></tr>
<tr><td class="num" id="LINE476">476</td><td class="line">*/    </td></tr>
<tr><td class="num" id="LINE477">477</td><td class="line">void limitedIF(int b) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/limitedIF.c0b0236d0630a89f60c64a629c794f68.html">summary for limitedIF</a></td></tr>
<tr><td class="num" id="LINE478">478</td><td class="line">  _(presumes true covers b &gt; 0) </td></tr>
<tr><td class="num" id="LINE479">479</td><td class="line">//_(presumes true covers b &lt; 5) </td></tr>
<tr><td class="num" id="LINE480">480</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE481">481</td><td class="line">  if (b &gt; 0) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:6 7 exn: Instructions
n$0=*&amp;b:int [line 481, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:3 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 481, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:3 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 481, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:7 6 succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE482">482</td><td class="line">    ; </td></tr>
<tr><td class="num" id="LINE483">483</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/limitedIF.c0b0236d0630a89f60c64a629c794f68_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE484">484</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE485">485</td><td class="line">/* Note that when SE strengthens a presumption with non-spatial assertions </td></tr>
<tr><td class="num" id="LINE486">486</td><td class="line">   it means the original contract did not hold. Underflow will report it therefore </td></tr>
<tr><td class="num" id="LINE487">487</td><td class="line">   as unreachable e.g. in the case of the commented-out contract below */ </td></tr>
<tr><td class="num" id="LINE488">488</td><td class="line">void error_and_insecure2(int x, int *p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure2.04ba13b71b7ed28643103700d99494c1_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:4 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/error_and_insecure2.04ba13b71b7ed28643103700d99494c1.html">summary for error_and_insecure2</a></td></tr>
<tr><td class="num" id="LINE489">489</td><td class="line">  _(presumes exists int v. p |-&gt; v &amp;*&amp; x :: low covers p |-\-&gt; &amp;*&amp; x :: low) </td></tr>
<tr><td class="num" id="LINE490">490</td><td class="line">  _(presumes p |-\-&gt; fails memory p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE491">491</td><td class="line">  _(presumes exists int v. p |-&gt; v fails insecure x :!: low &amp;*&amp; p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE492">492</td><td class="line">//_(presumes true fails insecure x :!: low &amp;*&amp; p |-\-&gt;) </td></tr>
<tr><td class="num" id="LINE493">493</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE494">494</td><td class="line">  free(p); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure2.04ba13b71b7ed28643103700d99494c1_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:1 succs:3 exn: Instructions
n$2=*&amp;p:int* [line 494, column 8];
n$3=_fun_free(n$2:int*) [line 494, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE495">495</td><td class="line">  output_low(x); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure2.04ba13b71b7ed28643103700d99494c1_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:4 succs:2 exn: Instructions
n$0=*&amp;x:int [line 495, column 14];
n$1=_fun_output_low(n$0:int) [line 495, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE496">496</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/error_and_insecure2.04ba13b71b7ed28643103700d99494c1_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE497">497</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE498">498</td><td class="line">int func2(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/func2.e55e8c1383d33fc3e11fbb6141dc467a.html">summary for func2</a></td></tr>
<tr><td class="num" id="LINE499">499</td><td class="line">  _(presumes x &gt;= 0 covers x &gt;= 0 &amp;&amp; result == x+1) </td></tr>
<tr><td class="num" id="LINE500">500</td><td class="line">  _(presumes true covers x &lt; 0 &amp;&amp; result == x) </td></tr>
<tr><td class="num" id="LINE501">501</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE502">502</td><td class="line">  if(x &gt;= 0){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:6 7 exn: Instructions
n$0=*&amp;x:int [line 502, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:11 exn: Conditional true Branch
PRUNE((n$0  &gt;=  0), true); [line 502, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:12 exn: Conditional false Branch
PRUNE(!(n$0  &gt;=  0), false); [line 502, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds: succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE503">503</td><td class="line">    int y = x; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node11.html"><span class='visited with_tooltip'>I_11<span class='tooltip'>node11 preds:6 succs:10 exn: Instructions
VARIABLE_DECLARED(y:int); [line 503, column 5];
n$2=*&amp;x:int [line 503, column 13];
*&amp;y:int=n$2 [line 503, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE504">504</td><td class="line">    x = 5; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node10.html"><span class='visited with_tooltip'>I_10<span class='tooltip'>node10 preds:11 succs:8 exn: Instructions
*&amp;x:int=5 [line 504, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE505">505</td><td class="line">    return (y+1); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:10 succs:9 exn: Instructions
n$1=*&amp;y:int [line 505, column 13];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:8 succs:2 exn: Instructions
*&amp;return:int=(n$1 + 1) [line 505, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE506">506</td><td class="line">  }else{ </td></tr>
<tr><td class="num" id="LINE507">507</td><td class="line">    return x; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node12.html"><span class='visited with_tooltip'>I_12<span class='tooltip'>node12 preds:7 succs:13 exn: Instructions
n$3=*&amp;x:int [line 507, column 12];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node13.html"><span class='visited with_tooltip'>I_13<span class='tooltip'>node13 preds:12 succs:2 exn: Instructions
*&amp;return:int=n$3 [line 507, column 5];
</span></span></a></td></tr>
<tr><td class="num" id="LINE508">508</td><td class="line">  } </td></tr>
<tr><td class="num" id="LINE509">509</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func2.e55e8c1383d33fc3e11fbb6141dc467a_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:13 9 4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE510">510</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE511">511</td><td class="line">int func1(int x) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:5 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/func1.3a78e0f3b66aacdc6416a39a7a42e07a.html">summary for func1</a></td></tr>
<tr><td class="num" id="LINE512">512</td><td class="line">  _(presumes true covers x &gt; 0 &amp;&amp; result == x+1) </td></tr>
<tr><td class="num" id="LINE513">513</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE514">514</td><td class="line">  if(x &gt; 0) return func2(x); else return x; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node5.html"><span class='visited with_tooltip'>I_5<span class='tooltip'>node5 preds:1 succs:6 7 exn: Instructions
n$0=*&amp;x:int [line 514, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:5 succs:8 exn: Conditional true Branch
PRUNE((n$0  &gt;  0), true); [line 514, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:6 succs:9 exn: Instructions
n$1=*&amp;x:int [line 514, column 26];
n$2=_fun_func2(n$1:int) [line 514, column 20];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node9.html"><span class='visited with_tooltip'>I_9<span class='tooltip'>node9 preds:8 succs:2 exn: Instructions
*&amp;return:int=n$2 [line 514, column 13];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node7.html"><span class='visited with_tooltip'>C_7<span class='tooltip'>node7 preds:5 succs:10 exn: Conditional false Branch
PRUNE(!(n$0  &gt;  0), false); [line 514, column 6];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node10.html"><span class='visited with_tooltip'>I_10<span class='tooltip'>node10 preds:7 succs:11 exn: Instructions
n$3=*&amp;x:int [line 514, column 42];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node11.html"><span class='visited with_tooltip'>I_11<span class='tooltip'>node11 preds:10 succs:2 exn: Instructions
*&amp;return:int=n$3 [line 514, column 35];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds: succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE515">515</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/func1.3a78e0f3b66aacdc6416a39a7a42e07a_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:11 9 4 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE516">516</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE517">517</td><td class="line">/* this contract is satisfied because of the equality in the result */ </td></tr>
<tr><td class="num" id="LINE518">518</td><td class="line">int test5(int *p) <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test5.e3d704f3542b44a621ebed70dc0efe13_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:3 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/test5.e3d704f3542b44a621ebed70dc0efe13.html">summary for test5</a></td></tr>
<tr><td class="num" id="LINE519">519</td><td class="line">  _(presumes exists int v, int y. p |-&gt; v covers p |-&gt; y &amp;*&amp; result == 0 &amp;&amp; v == y) </td></tr>
<tr><td class="num" id="LINE520">520</td><td class="line">{ </td></tr>
<tr><td class="num" id="LINE521">521</td><td class="line">  return 0; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test5.e3d704f3542b44a621ebed70dc0efe13_node3.html"><span class='visited with_tooltip'>I_3<span class='tooltip'>node3 preds:1 succs:2 exn: Instructions
*&amp;return:int=0 [line 521, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE522">522</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/test5.e3d704f3542b44a621ebed70dc0efe13_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:3 succs: exn: Exit
</span></span></a></td></tr>
<tr><td class="num" id="LINE523">523</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE524">524</td><td class="line"> </td></tr>
<tr><td class="num" id="LINE525">525</td><td class="line">void load_and_branch(int *arr, int off){ <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node1.html"><span class='visited with_tooltip'>S_1<span class='tooltip'>node1 preds: succs:8 exn: Start
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/load_and_branch.b95f1d1b3387597cb712104035aa8703.html">summary for load_and_branch</a></td></tr>
<tr><td class="num" id="LINE526">526</td><td class="line">  int *p = arr + off; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node8.html"><span class='visited with_tooltip'>I_8<span class='tooltip'>node8 preds:1 succs:7 exn: Instructions
VARIABLE_DECLARED(p:int*); [line 526, column 3];
n$6=*&amp;arr:int* [line 526, column 12];
n$7=*&amp;off:int [line 526, column 18];
*&amp;p:int*=(n$6 + n$7) [line 526, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE527">527</td><td class="line">  int v = *p; <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node7.html"><span class='visited with_tooltip'>I_7<span class='tooltip'>node7 preds:8 succs:5 6 exn: Instructions
VARIABLE_DECLARED(v:int); [line 527, column 3];
n$4=*&amp;p:int* [line 527, column 12];
n$5=*n$4:int [line 527, column 11];
*&amp;v:int=n$5 [line 527, column 3];
</span></span></a></td></tr>
<tr><td class="num" id="LINE528">528</td><td class="line">  if (v); <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node5.html"><span class='visited with_tooltip'>C_5<span class='tooltip'>node5 preds:7 succs:3 exn: Conditional true Branch
n$0=*&amp;v:int [line 528, column 7];
PRUNE(n$0, true); [line 528, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node6.html"><span class='visited with_tooltip'>C_6<span class='tooltip'>node6 preds:7 succs:3 exn: Conditional false Branch
n$0=*&amp;v:int [line 528, column 7];
PRUNE(!n$0, false); [line 528, column 7];
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node3.html"><span class='visited with_tooltip'>J_3<span class='tooltip'>node3 preds:6 5 succs:4 exn: Join
</span></span></a> <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node4.html"><span class='visited with_tooltip'>I_4<span class='tooltip'>node4 preds:3 succs:2 exn: Instructions
</span></span></a></td></tr>
<tr><td class="num" id="LINE529">529</td><td class="line">} <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/load_and_branch.b95f1d1b3387597cb712104035aa8703_node2.html"><span class='visited with_tooltip'>E_2<span class='tooltip'>node2 preds:4 succs: exn: Exit
</span></span></a></td></tr>
</table>

<hr width="100%">
LIKE DURING FOOTPRINT

<hr width="100%">
INFO DURING FOOTPRINT

<hr width="100%">
ADVICE DURING FOOTPRINT

<hr width="100%">
WARNING DURING FOOTPRINT

<hr width="100%">
ERROR DURING FOOTPRINT
<br>Use After Free Pulse found a potential null pointer dereference  on line 245. <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/node0.html">node0</a>(<a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/../insec.c.8bbf6441c46fd2c488a9a5719116ed53.html#LINE246">246</a>)<br>Use After Free Pulse found a potential null pointer dereference  on line 447 indirectly during the call to `push_back()`. <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/node0.html">node0</a>(<a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/../insec.c.8bbf6441c46fd2c488a9a5719116ed53.html#LINE448">448</a>)<br>Use After Free Pulse found a potential null pointer dereference  on line 229. <a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/nodes/node0.html">node0</a>(<a href="./insec.c.8bbf6441c46fd2c488a9a5719116ed53/../insec.c.8bbf6441c46fd2c488a9a5719116ed53.html#LINE230">230</a>)</body>
</html>
